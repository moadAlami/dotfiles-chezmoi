#!/usr/bin/env sh

if [[ -n $WAYLAND_DISPLAY ]]; then
	menu="rofi -dmenu"
elif [[ -n $DISPLAY ]]; then
	menu="dmenu"
fi

[ $(echo -e 'Yes\nNo' | $menu -i -p 'Are you sure you want to shutdown?') == 'Yes' ] && while pgrep mbsync > /dev/null 2>&1;do
notify-send '‚è≥ Waiting for mbsync to finish.'
sleep 1
done

notify-send 'üõë Shutting down' && shutdown now

# TODO
# Add cancellation option with shutdown --show and -c (cancel)
